<h2></h2>-c-c-c-<h1 style="font-size: 250%;">ロボットシステム学</h1>-c-c-c-<h2>第13回</h2>-c-c-c-上田 隆一-c-c-c--c-c-c-2017年1月18日\@千葉工業大学-c-c-c--c-c-c-<!--nextpage-->-c-c-c-<h2>本日の内容</h2>-c-c-c-<ul>-c-c-c- 	<li>ROS-c-c-c-<ul>-c-c-c- 	<li>ROSのインストールが終わった状態からスタート</li>-c-c-c- 	<li>ノード間の通信</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<h2></h2>-c-c-c-<!--nextpage-->-c-c-c-<h2>動作確認</h2>-c-c-c-<ul>-c-c-c- 	<li>$ roscore-c-c-c-<ul>-c-c-c- 	<li>ROSのバックにいるプログラムが立ち上がる</li>-c-c-c- 	<li>Ctrl+cで出る</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<pre><span style="color: #ffffff;">$ roscore</span>-c-c-c-<span style="color: #ffffff;">（略）</span>-c-c-c-<span style="color: #ffffff;">started roslaunch server http://localhost:39310/</span>-c-c-c-<span style="color: #ffffff;">ros_comm version 1.12.6</span>-c-c-c--c-c-c-<span style="color: #ffffff;">SUMMARY</span>-c-c-c-<span style="color: #ffffff;">========</span>-c-c-c--c-c-c-<span style="color: #ffffff;">PARAMETERS</span>-c-c-c-<span style="color: #ffffff;">* /rosdistro: kinetic</span>-c-c-c-<span style="color: #ffffff;">* /rosversion: 1.12.6</span>-c-c-c--c-c-c-<span style="color: #ffffff;">NODES</span>-c-c-c--c-c-c-<span style="color: #ffffff;">auto-starting new master</span>-c-c-c-<span style="color: #ffffff;">process[master]: started with pid [1439]</span>-c-c-c-<span style="color: #ffffff;">ROS_MASTER_URI=http://localhost:11311/</span>-c-c-c--c-c-c-<span style="color: #ffffff;">setting /run_id to b749a100-d0dc-11e5-a506-b827eb17cb96</span>-c-c-c-<span style="color: #ffffff;">process[rosout-1]: started with pid [1452]</span>-c-c-c-<span style="color: #ffffff;">started core service [/rosout]</span></pre>-c-c-c-<!--nextpage-->-c-c-c-<h2>ROSのノード</h2>-c-c-c-<ul>-c-c-c- 	<li>プログラムのプロセス一つ一つが「ノード」と呼ばれる</li>-c-c-c- 	<li>ノードの例-c-c-c-<ul>-c-c-c- 	<li>cv_cameraとmjpeg_serverを立ち上げる（roscoreは立ち上げておく）</li>-c-c-c- 	<li>-c-c-c-<pre class="p1"><span class="s1"><span style="color: #ffffff;">$ rosrun cv_camera cv_camera_node</span> -c-c-c-</span><span class="s1"><span style="color: #ffffff;">$ rosrun mjpeg_server mjpeg_server</span> </span></pre>-c-c-c-</li>-c-c-c- 	<li>ノードの確認-c-c-c-<pre><span style="color: #ffffff;">$ rosnode list-c-c-c-<span class="s1">/cv_camera-c-c-c-</span><span class="s1">/mjpeg_server-c-c-c-</span><span class="s1">/rosout</span></span></pre>-c-c-c-</li>-c-c-c- 	<li>ディレクトリのように管理されている</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>トピック・メッセージ</h2>-c-c-c-<ul>-c-c-c- 	<li>今度はrostopic listと打ってみる</li>-c-c-c- 	<li>データをやり取りする口（トピック）が表示される</li>-c-c-c- 	<li>-c-c-c-<pre class="p1"><span class="s1" style="color: #ffffff;">$ rostopic list</span>-c-c-c-<span class="s1" style="color: #ffffff;">/cv_camera/camera_info</span>-c-c-c-<span class="s1" style="color: #ffffff;">/cv_camera/image_raw</span>-c-c-c-<span class="s1" style="color: #ffffff;">/rosout</span>-c-c-c-<span class="s1" style="color: #ffffff;">/rosout_agg</span></pre>-c-c-c-</li>-c-c-c- 	<li>トピックからデータを取り出す（先週もやりました）</li>-c-c-c- 	<li>-c-c-c-<pre class="p1"><span class="s1" style="color: #ffffff;">$ rostopic echo /cv_camera/image_raw</span></pre>-c-c-c-<ul>-c-c-c- 	<li>このデータは「メッセージ」と呼ばれる</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<h2><!--nextpage--></h2>-c-c-c-<h2>パブリッシャ・サブスクライバ</h2>-c-c-c-<ul>-c-c-c- 	<li>各ノードがトピックを通じてメッセージを融通することで全体として仕事を行う</li>-c-c-c- 	<li>mjpeg_serverは/cv_camera/image_rawからカメラ画像を取得して、ブラウザに画像を配信</li>-c-c-c- 	<li>データを出す側が<span style="color: #ff0000;">パブリッシャ</span></li>-c-c-c- 	<li>データを受け取る側が<span style="color: #ff0000;">サブスクライバ</span></li>-c-c-c- 	<li>この構造でサブスクライバ側を柔軟に組み替えることができるようになる-c-c-c-<ul>-c-c-c- 	<li>ブラウザに配信するノード、顔検出をするノード、mp4に変換するノード・・・</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<h2><!--nextpage--></h2>-c-c-c-<h2>通信の大雑把な説明</h2>
