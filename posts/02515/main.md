&nbsp;-c-c-c-<h1 style="font-size: 250%;">確率ロボティクス</h1>-c-c-c-<h2>第10回</h2>-c-c-c-上田 隆一-c-c-c--c-c-c-2016年12月7日\@千葉工業大学-c-c-c--c-c-c-<!--nextpage-->-c-c-c-<h2>本日の内容</h2>-c-c-c-<ul>-c-c-c- 	<li>POMDP</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>POMDP</h2>-c-c-c-<ul>-c-c-c- 	<li>部分観測マルコフ決定過程</li>-c-c-c- 	<li>状態が自明でない場合のマルコフ決定過程-c-c-c-<ul>-c-c-c- 	<li>センサ情報から得られるが、部分的</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>ほぼ、自律型ロボットの問題と等価-c-c-c-<ul>-c-c-c- 	<li>状態が分かっているものをロボットと言うかどうか</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>他者がいるとさらに問題が難しくなるが、-c-c-c-POMDPでは考えない/扱えない</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>定式化</h2>-c-c-c-<ul>-c-c-c- 	<li>状態が直接観測できず、観測から間接的に分かる-c-c-c-<ul>-c-c-c- 	<li>要は自己位置推定の問題に行動決定をくっつけたもの</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>各シンボルの定義-c-c-c-<ul>-c-c-c- 	<li>時刻: [latex]\\mathcal{T} = \\{t | t=0,1,2,\\dots,T\\}[/latex]</li>-c-c-c- 	<li>状態: [latex]\\mathcal{S} = \\{s_i | i=1,2,3,\\dots,N\\}[/latex]-c-c-c-<ul>-c-c-c- 	<li>どんな状態があるかはknown、どの状態にいるかはunknown</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>行動: [latex]\\mathcal{A} = \\{a_j | j=1,2,3,\\dots,M\\}[/latex]</li>-c-c-c- 	<li>状態遷移: [latex]\\mathcal{P}_{ss'}^a[/latex]</li>-c-c-c- 	<li>報酬: [latex]\\mathcal{R}_{ss'}^a[/latex]</li>-c-c-c- 	<li>観測: [latex]\\mathcal{O}[/latex]</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>問題の例</h2>-c-c-c-<ul>-c-c-c- 	<li>スイカ割り-c-c-c-<ul>-c-c-c- 	<li>自分とスイカの相対姿勢がはっきり分からない</li>-c-c-c- 	<li>他者からの情報で</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>真っ暗なビルから脱出-c-c-c-<ul>-c-c-c- 	<li>壁に手をついて自己位置推定</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>実はスイカ割りで目隠しを取っても、ビルに照明がついていても、我々は正確な位置計測ができている訳ではない-c-c-c-<ul>-c-c-c- 	<li>結局POMDP</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>自己位置推定の曖昧さ</h2>-c-c-c-<ul>-c-c-c- 	<li>例えばパーティクルフィルタでもカルマンフィルタでも<a href="https://lab.ueda.asia/wp-content/uploads/2016/12/particle_mean.png"><img class="alignright size-medium wp-image-2471" src="https://lab.ueda.asia/wp-content/uploads/2016/12/particle_mean-300x151.png" alt="particle_mean" width="300" height="151" /></a>-c-c-c-分布は常に広がりを持つ</li>-c-c-c-</ul>-c-c-c-<ul>-c-c-c- 	<li>広がっているときに平均値（と決定論的方策[latex]\\pi[/latex]）を信じて動くとどうなるか？</li>-c-c-c- 	<li>そもそも平均値が意味を持たないこともある</li>-c-c-c- 	<li style="color: white;"></li>-c-c-c- 	<li>平均値でなくてもっといい行動の選び方はないだろうか？</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>入力が信念の方策</h2>-c-c-c-<ul>-c-c-c- 	<li>エージェントが[latex]bel[/latex]から行動決定</li>-c-c-c- 	<li>状態空間の上で定義された方策ではなく、[latex]bel[/latex]が属する空間の上で定義された方策となる-c-c-c-<ul>-c-c-c- 	<li>「信念に対する方策」「信念方策」</li>-c-c-c- 	<li style="color: white;"></li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>どうやって求めるか？</li>-c-c-c- 	<li>そもそも求められるのか？</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>問題の大きさ</h2>-c-c-c-<ul>-c-c-c- 	<li>状態が100個、行動が2種類の場合</li>-c-c-c- 	<li>有限MDP-c-c-c-<ul>-c-c-c- 	<li>方策のパターンは[latex]2^{100}[/latex]通り</li>-c-c-c- 	<li>価値反復を使うと-c-c-c-<ul>-c-c-c- 	<li>[latex]O[/latex](状態数・行動数・タスクの長さ)で方策を計算可能</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>POMDP-c-c-c-<ul>-c-c-c- 	<li>[latex]bel[/latex]は100個の状態上で定義される関数-c-c-c-<ul>-c-c-c- 	<li>無限に存在</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>無限にあるものに対する方策のパターンは無限</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>POMDPと-c-c-c-ハンドコーディング</h2>-c-c-c-<ul>-c-c-c- 	<li>例えば、パーティクルの分布から移動ロボットの行動を決めるコードを書いてみましょう-c-c-c-<ul>-c-c-c- 	<li>例えば脱輪したり縁石に乗り上げたりしないで、できるだけ早く角を曲がる場合を考えてみましょう</li>-c-c-c- 	<li>（たいていの場合）ほぼ無限に場合分けできる-c-c-c-<ul>-c-c-c- 	<li><span style="color: #ff0000;">疲れる</span></li>-c-c-c- 	<li>そもそも無理？</li>-c-c-c- 	<li style="color: white;"></li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>豊富な研究テーマ<img class="alignright wp-image-2487" src="https://lab.ueda.asia/wp-content/uploads/2016/12/corner-300x110.png" alt="corner" width="403" height="157" /></li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>対策</h2>-c-c-c-<ul>-c-c-c- 	<li>センサを強化</li>-c-c-c- 	<li style="color: white;"></li>-c-c-c- 	<li>観測戦略-c-c-c-<ul>-c-c-c- 	<li>位置の情報が得られそうな行動を能動的にとる</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li style="color: white;"></li>-c-c-c- 	<li>センサやアクチュエータの配置、ロボットの形状の工夫<span style="color: #ff0000;">（身体性）</span>-c-c-c-<ul>-c-c-c- 	<li>ぶつかっても壊れない</li>-c-c-c- 	<li>情報を得やすい位置にセンサをつける</li>-c-c-c- 	<li>情報を得やすい/情報がなくても動けるようにアクチュエータを選定して取り付け</li>-c-c-c- 	<li style="color: white;"></li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>計算でなんとか良い行動を見つける</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>計算でなんとか</h2>-c-c-c-<ul>-c-c-c- 	<li>だいたい以下のような方針になる</li>-c-c-c- 	<li>方法1:-c-c-c-<ul>-c-c-c- 	<li>[latex]bel[/latex]の形状一個一個を状態と皆して有限MDPのように問題を解く</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>方法2:-c-c-c-<ul>-c-c-c- 	<li>事前に状態が既知の有限MDPの問題を解いて[latex]bel[/latex]からなんとか行動を得る</li>-c-c-c- 	<li>分布の平均値やその他代表値を1つ選んで行動決定するのもこの方法の単純な実装</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>方法1-c-c-c-<span style="font-size: 80%;">（AMDPと呼ばれる手法群）</span></h2>-c-c-c-<ul>-c-c-c- 	<li>信念の数を有限個に近似</li>-c-c-c- 	<li>例[Roy 99]-c-c-c-<ul>-c-c-c- 	<li>距離センサを持つ移動ロボットのナビゲーション問題</li>-c-c-c- 	<li>4次元の状態空間を作る-c-c-c-<ul>-c-c-c- 	<li>[latex]xy\\theta[/latex]を離散化</li>-c-c-c- 	<li>[latex]bel[/latex]がどれだけ曖昧か数値化して離散化</li>-c-c-c- 	<li>状態遷移はなんとか計算</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>あとは価値反復等で計算</li>-c-c-c- 	<li style="color: white;"></li>-c-c-c- 	<li>得られる行動-c-c-c-<ul>-c-c-c- 	<li><span style="color: #ff0000;">自己位置が分からなくならないように壁沿いを走る</span></li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>方法2（[latex]Q_\\text{MDP}[/latex], 他）</h2>-c-c-c-<ul>-c-c-c- 	<li>有限MDPの計算結果を利用する-c-c-c-<ul>-c-c-c- 	<li>状態遷移の法則性が分かっているが、ロボットが自分の状態を完全に分からない場合に使える</li>-c-c-c- 	<li style="color: white;"></li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>例[Littman95]-c-c-c-<ul>-c-c-c- 	<li>確率密度関数[latex]bel[/latex]と価値関数[latex]V[/latex]から価値の期待値を計算</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>[latex]Q_\\text{MDP}[/latex]の例</h2>-c-c-c-<ul>-c-c-c- 	<li>碁盤の目の環境を考える-c-c-c-<ul>-c-c-c- 	<li><a href="https://lab.ueda.asia/wp-content/uploads/2016/12/qmdp.png"><img class="alignright wp-image-2501" src="https://lab.ueda.asia/wp-content/uploads/2016/12/qmdp-300x278.png" alt="qmdp" width="246" height="229" /></a>1マスが1状態</li>-c-c-c- 	<li>行動は上下左右</li>-c-c-c- 	<li>同じ重みを持ったパーティクル10個が分布</li>-c-c-c- 	<li>タスクはゴール（G）に最短歩数で到達すること</li>-c-c-c- 	<li>数字はコスト</li>-c-c-c- 	<li>灰色のところに入ろうとすると戻される</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>問題: 一番「価値の高い」行動は？</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<ul>-c-c-c- 	<li>この環境だとどうなる？</li>-c-c-c-</ul>-c-c-c-<a href="https://lab.ueda.asia/wp-content/uploads/2016/12/qmpd2.png"><img class="size-medium wp-image-2503 alignnone" src="https://lab.ueda.asia/wp-content/uploads/2016/12/qmpd2-300x277.png" alt="qmpd2" width="300" height="277" /></a>-c-c-c--c-c-c-<!--nextpage-->-c-c-c-<h2>最近やっている研究</h2>-c-c-c-<ul>-c-c-c- 	<li>probabilistic flow control[Ueda 2015]<a href="https://lab.ueda.asia/wp-content/uploads/2016/12/pfc.png"><img class="alignright wp-image-2506" src="https://lab.ueda.asia/wp-content/uploads/2016/12/pfc-248x300.png" alt="pfc" width="300" height="362" /></a>-c-c-c-<ul>-c-c-c- 	<li>期待値計算において「重み = パーティクルの重み/価値」とする-c-c-c-<ul>-c-c-c- 	<li>ゴールに近いパーティクルが行動決定に大きな影響を与える</li>-c-c-c- 	<li>投機的な行動が生成され、ロボットがゴールを探すようになる</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>ただしこれでもデッドロックは発生-c-c-c-<ul>-c-c-c- 	<li>研究は続く・・・</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>PFCで動くロボット</h2>-c-c-c-<img class="alignright size-medium wp-image-2514" src="https://lab.ueda.asia/wp-content/uploads/2016/12/pfc_robot-300x292.png" alt="pfc_robot" width="300" height="292" />-c-c-c--c-c-c-<iframe src="https://www.youtube.com/embed/qs7JUygUzyI" width="560" height="315" frameborder="0" allowfullscreen="allowfullscreen"></iframe>
