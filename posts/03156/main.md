<h2>ロボットシステム学</h2>-c-c-c-<h2>第2回</h2>-c-c-c-上田 隆一-c-c-c--c-c-c-2016年9月27日\@千葉工業大学-c-c-c--c-c-c-<!--nextpage-->-c-c-c-<h2>今日の内容</h2>-c-c-c-<ul>-c-c-c- 	<li>ノートPCとラズパイを接続</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>やること</h2>-c-c-c-<ul>-c-c-c- 	<li>下の写真のようにノートPCとラズパイを有線LANで直接接続</li>-c-c-c- 	<li>次のような接続を構成-c-c-c-<ul>-c-c-c- 	<li>ラズパイ -&gt; 有線LAN -&gt; ノートPC -&gt; ノートPCのWiFi -&gt; インターネット</li>-c-c-c- 	<li>つまりノートPCをルータにする</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c--c-c-c-<blockquote class="twitter-tweet" data-lang="ja"><p lang="ja" dir="ltr">今度は、ノートPCとラズパイをUSB、LANケーブルで結びます。私のMacだとこのザマですが、普通のノートPCならもうちょいスッキリしているはずです。 <a href="https://twitter.com/hashtag/robosys2017?src=hash">#robosys2017</a> <a href="https://t.co/MZRurPg3ua">pic.twitter.com/MZRurPg3ua</a></p>&mdash; Ryuichi Ueda (\@ryuichiueda) <a href="https://twitter.com/ryuichiueda/status/911498810081165312">2017年9月23日</a></blockquote>-c-c-c-<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>-c-c-c--c-c-c-<!--nextpage-->-c-c-c-<h2>ノートPCのOS別設定方法</h2>-c-c-c-<ul>-c-c-c- 	<li>Windows: <a href="https://blog.ueda.tech/?p=8694" target="_blank" rel="noopener">https://blog.ueda.tech/?p=8694</a>-c-c-c-<ul>-c-c-c- 	<li>拙ブログですみません</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>Mac: <a href="https://blog.ueda.tech/?p=8717" target="_blank" rel="noopener">https://blog.ueda.tech/?p=8717</a>-c-c-c-<ul>-c-c-c- 	<li>こちらも拙ブログですみません</li>-c-c-c- 	<li>ラズパイのIPの調べ方-c-c-c-<ul>-c-c-c- 	<li>-c-c-c-<p class="p1"><span class="s1">$ nmap -sP &lt;有線側のセグメント&gt;</span></p>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>Linux: DHCPを立てるのが面倒なので割愛</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>Linuxの世界</h2>-c-c-c-<ul>-c-c-c- 	<li>ほぼ全てテキストファイルでできている-c-c-c-<ul>-c-c-c- 	<li>設定ファイル等-c-c-c-<ul>-c-c-c- 	<li>/etc下のファイルを見てみましょう</li>-c-c-c- 	<li><code>$ cat /etc/passwd</code></li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>どうやって見る？編集する？-c-c-c-<ul>-c-c-c- 	<li>エディタ</li>-c-c-c- 	<li>コマンド</li>-c-c-c- 	<li>使えないとかなりストレス-c-c-c-<ul>-c-c-c- 	<li>自転車と一緒で使えると自然に使えるようになるので-c-c-c-我慢して慣れられるかどうかで今後が変わる</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>エディタ</h2>-c-c-c-<ul>-c-c-c- 	<li>（CLI, command line interface）でテキストファイルを読み書きするもの-c-c-c-<ul>-c-c-c- 	<li>EmacsとVimがメジャー</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>特にここでは説明しません-c-c-c-<ul>-c-c-c- 	<li>練習コマンドがあるのでそれで練習を</li>-c-c-c- 	<li>Vimにはvimtutorというコマンドがあり、-c-c-c-最初はこれをやるのが一番良い</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>コマンド</h2>-c-c-c-<ul>-c-c-c- 	<li>CUIからプログラムを起動する場合は字をシェルに打ち込むが、その字のこと-c-c-c-<ul>-c-c-c- 	<li>プログラム自身のことも指し、このスライドではプログラム自身のこと</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>だいたいこの二種類-c-c-c-<ul>-c-c-c- 	<li>システム操作のためのコマンド-c-c-c-<ul>-c-c-c- 	<li>サービスを立ち上げたり止めたり</li>-c-c-c- 	<li>これはマニュアルを見たら覚えられる</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>フィルタコマンド-c-c-c-<ul>-c-c-c- 	<li>標準入力から文字を受けて標準出力に加工した字を出すもの</li>-c-c-c- 	<li>組み合わせて使う（マニュアルがあまりない）</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>フィルタコマンド</h2>-c-c-c-<ul>-c-c-c- 	<li>多数: grep, find, wc, ...-c-c-c-<ul>-c-c-c- 	<li>/bin/下に存在</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>とりあえず最初に覚えるもの-c-c-c-<ul>-c-c-c- 	<li>cat: 表示</li>-c-c-c- 	<li>sudo: root権限でコマンドを実行-c-c-c-<ol>-c-c-c- 	<li>$ sudo cat /etc/shadow</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c- 	<li>grep: 検索-c-c-c-<ol>-c-c-c- 	<li>$ grep ueda /etc/passwd</li>-c-c-c- 	<li>ueda:x:1000:1000:Ryuichi UEDA,,,:/home/ueda:/bin/bash</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c- 	<li>find: ファイルの列挙-c-c-c-<ul>-c-c-c- 	<li>使い方の例-c-c-c-<ol>-c-c-c- 	<li>$ find /</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c- 	<li>出力がザーッと出て使いにくくないか？</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>コマンドの組み合わせ</h2>-c-c-c-<ul>-c-c-c- 	<li>特定のファイルを探すには？-c-c-c-<ul>-c-c-c- 	<li>例: passwdファイルってどこにあったけ？</li>-c-c-c- 	<li>grepと組み合わせる-c-c-c-<ol>-c-c-c- 	<li>sudo find / | grep passwd</li>-c-c-c- 	<li>[sudo] password for ueda:</li>-c-c-c- 	<li>./var/lib/dpkg/info/passwd.postinst</li>-c-c-c- 	<li>./var/lib/dpkg/info/base-passwd.postinst</li>-c-c-c- 	<li>./var/lib/dpkg/info/passwd.preinst</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c- 	<li>さらに絞り込む（grepで正規表現を使う）-c-c-c-<ol>-c-c-c- 	<li>$ sudo find / | grep '/passwd$'</li>-c-c-c- 	<li>/var/tmp/etc/init.d/passwd</li>-c-c-c- 	<li>/var/tmp/etc/cron.daily/passwd</li>-c-c-c- 	<li>...</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c- 	<li>lessで見る-c-c-c-<ol>-c-c-c- 	<li>sudo find / | less</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>正規表現の例</h2>-c-c-c-<ul>-c-c-c- 	<li>正規表現の例-c-c-c-<ul>-c-c-c- 	<li> /etc/servicesの調査-c-c-c-<ol>-c-c-c- 	<li>$ cat /etc/services | grep 80　　         #80を検索</li>-c-c-c- 	<li>$ cat /etc/services | grep '[^0-9]80/'  #80番ポートのレコードだけ検索</li>-c-c-c- 	<li>$ cat /etc/services | grep ftp                #ftpという語句を検索</li>-c-c-c- 	<li>$ cat /etc/services | grep ^ftp       #最初がftpで始まる行を検索</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>上級者向け-c-c-c-<ul>-c-c-c- 	<li>AWKとgrepで10000番ポート以上のレコードを抽出のこと</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>ファイルの操作</h2>-c-c-c-<ul>-c-c-c- 	<li>ls, mv, rm, cp, mkdir, rmdir-c-c-c-<ul>-c-c-c- 	<li>口頭で説明します</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>man</h2>-c-c-c-<ul>-c-c-c- 	<li>マニュアルコマンド-c-c-c-<ol>-c-c-c- 	<li>$ man grep</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c- 	<li>章がある-c-c-c-<ol>-c-c-c- 	<li>$ man 1 printf      #1章（コマンド）のprintf</li>-c-c-c- 	<li>$ man 3 printf      #3章（C言語の関数）のprintf</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c- 	<li>詳しくは $ man man で。</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>apt, apt-get</h2>-c-c-c-<ul>-c-c-c- 	<li>ソフトウェアのインストール-c-c-c-<ul>-c-c-c- 	<li>API (Advanced Packaging Tool): Debian系Linuxの-c-c-c-パッケージシステム</li>-c-c-c- 	<li>使用例-c-c-c-<ul>-c-c-c- 	<li><span class="s1">$</span><span class="s2"> sudo apt-get install nmap   #旧</span></li>-c-c-c- 	<li>$ sudo apt install nmap         #新</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>ping</h2>-c-c-c-<ul>-c-c-c- 	<li>通信先にパケットが届くか確認する時によく使う-c-c-c-<ol>-c-c-c- 	<li>$ ping 8.8.8.8-c-c-c-<ul>-c-c-c- 	<li>GoogleのDNSにパケットが届くか確認</li>-c-c-c- 	<li>インターネットに出られるか確認する時によく使用</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>$ ping www.yahoo.co.jp-c-c-c-<ul>-c-c-c- 	<li>ドメイン名をIPに変換できるか（名前解決）を確認する時に使用</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>$ ping 192.168.1.254-c-c-c-<ul>-c-c-c- 	<li>192.168.1.254に届くか確認-c-c-c-<ul>-c-c-c- 	<li>（192.168.1.254はルーターっぽいIPアドレス）</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ol>-c-c-c-<ul>-c-c-c- 	<li>たまにセキュリティーのために先方がふさがっていることがある</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>ip, ifconfig</h2>-c-c-c-<ul>-c-c-c- 	<li>ネットワークの設定の確認-c-c-c-<ul>-c-c-c- 	<li>ifconfig: 古い確認方法-c-c-c-<ol>-c-c-c- 	<li>$ ifconfig</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c- 	<li>ip: 新しい方法-c-c-c-<ol>-c-c-c- 	<li>$ ip addr show    #IPアドレス等の確認</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>その他通信関係のコマンド</h2>-c-c-c-<ul>-c-c-c- 	<li>nmap: ネットワークのスキャン-c-c-c-<ul>-c-c-c- 	<li>インターネットに向けてやると最悪裁判になるので注意</li>-c-c-c- 	<li>使用例-c-c-c-<ol>-c-c-c- 	<li><span class="s1">$</span><span class="s2"> nmap -sP 192.168.3.0/24   #自分のネットワークのマシンのIPアドレスを調査</span></li>-c-c-c- 	<li>$ nmap 192.168.3.2 #開いているポートの調査</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>traceroute-c-c-c-<ul>-c-c-c- 	<li> パケットの運ばれる経路を調査-c-c-c-<ol>-c-c-c- 	<li>$ traceroute 8.8.8.8</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>scp, rsync</h2>-c-c-c-<ul>-c-c-c- 	<li>マシン間でファイルをコピー-c-c-c-<ol>-c-c-c- 	<li>$ scp hoge 192.168.3.1~/     #hogeファイルを192..1のホームへ</li>-c-c-c- 	<li>$ scp 192.168.3.1:~/hoge2 ./  #逆向き</li>-c-c-c- 	<li>$ rsync -av hoge/ 192.168.3.1:~/hoge/ #hogeディレクトリを192..1のホームへ</li>-c-c-c- 	<li>$ rsync -av192.168.3.1:~/hoge/ hoge/   #逆向き</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c- 	<li>TeraTermにもscp機能がある</li>-c-c-c-</ul>-c-c-c-&nbsp;-c-c-c--c-c-c-<!--nextpage-->-c-c-c-<h2>停止・再起動</h2>-c-c-c-<ul>-c-c-c- 	<li>停止-c-c-c-<ul>-c-c-c- 	<li>次の2通り-c-c-c-<ul>-c-c-c- 	<li>$ sudo shutdown -h now</li>-c-c-c- 	<li>$ sudo poweroff</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>Linuxはデータをストレージに後から書き込むので 、ラズパイの場合は緑のランプが点滅しなくなるまでよく待つ-c-c-c-<ul>-c-c-c- 	<li>ストレージ: HDD, SSD, microSD, ...</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>一方、ラズパイはプログラムやデータ等を別のマシンで管理する-c-c-c-場合が多いのでブチ切りする人が多く、特に問題にならない</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>再起動-c-c-c-<ul>-c-c-c- 	<li>$ sudo reboot</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>プログラムのコンパイル</h2>-c-c-c-<ul>-c-c-c- 	<li>次のようなC言語のファイルhoge.cを作ってみましょう-c-c-c-<ul>-c-c-c- 	<li>端末のエディタがまだ使えない人はこの資料のコピペやscp等を駆使のこと</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<pre>#include &lt;stdio.h&gt;-c-c-c-int main(int argc, char const* argv[]){-c-c-c-    puts("あばばばば");-c-c-c-    return 0;-c-c-c-}</pre>-c-c-c-<ul>-c-c-c- 	<li>gccを使ってコンパイルし、a.outを実行-c-c-c-<ol>-c-c-c- 	<li>$ gcc hoge.c</li>-c-c-c- 	<li>$ ./a.out</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c- 	<li>もしa.outが実行できなかったら $ chmod +x a.out</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>スクリプトの実行</h2>-c-c-c-<ul>-c-c-c- 	<li>次のようなPyhonのファイルhoge.pyを作ってみましょう</li>-c-c-c-</ul>-c-c-c-<pre>#!/usr/bin/python-c-c-c-print "Java"-c-c-c-</pre>-c-c-c-<ul>-c-c-c- 	<li>以下を実行-c-c-c-<ol>-c-c-c- 	<li>-c-c-c-<p class="p1"><span class="s1">$</span><span class="s2"> chmod +x hoge.py</span></p>-c-c-c-</li>-c-c-c- 	<li>-c-c-c-<p class="p1"><span class="s1">$</span><span class="s2"> ./hoge.py</span></p>-c-c-c-</li>-c-c-c-</ol>-c-c-c-</li>-c-c-c- 	<li>#!: シバン（shebang）-c-c-c-<ul>-c-c-c- 	<li>どのプログラムでこのスクリプトを実行するか指定</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>Raspbianのメンテナンス</h2>-c-c-c-<ul>-c-c-c- 	<li>rpi-update: カーネル等のアップデート-c-c-c-<ul>-c-c-c- 	<li>pi\@raspberrypi:~ $ sudo rpi-update</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>apt update: パッケージリストの更新-c-c-c-<ul>-c-c-c- 	<li>pi\@raspberrypi:~ $ sudo apt update</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>apt upgrade: パッケージのアップグレード-c-c-c-<ul>-c-c-c- 	<li>pi\@raspberrypi:~ $ sudo apt upgrade</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>raspi-config: Raspberry Piの機能設定-c-c-c-<ul>-c-c-c- 	<li>pi\@raspberrypi<span class="s2">:</span><span class="s3">~ $</span><span class="s2"> sudo raspi-config</span></li>-c-c-c- 	<li>ロケールの設定</li>-c-c-c- 	<li>言語環境の設定</li>-c-c-c- 	<li>起動時にGUIの抑制</li>-c-c-c- 	<li>SPI等の機能をON/OFF</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<!--nextpage-->-c-c-c-<h2>次回までの宿題<del></del></h2>-c-c-c-<ul>-c-c-c- 	<li>エディタが苦手な人はvimtutorをやっておく-c-c-c-<ul>-c-c-c- 	<li>$ vimtutor</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c- 	<li>得意な人はVimやEmacsにプラグインを仕込む-c-c-c-<ul>-c-c-c- 	<li>Vimの場合はdein等-c-c-c-<ul>-c-c-c- 	<li><a href="https://github.com/Shougo/dein.vim" target="_blank" rel="noopener">https://github.com/Shougo/dein.vim</a></li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-</li>-c-c-c-</ul>-c-c-c-<h2><!--nextpage--></h2>-c-c-c-<h2>補足</h2>-c-c-c-<ul>-c-c-c- 	<li>SSH接続でこういうのが出た時</li>-c-c-c-</ul>-c-c-c-<pre>\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@-c-c-c-\@ WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED! \@-c-c-c-\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@</pre>-c-c-c-<ul>-c-c-c- 	<li>~/.ssh/known_hosts から接続先のIPアドレスを見つけてレコードを削除</li>-c-c-c-</ul>
