<h1 style="font-size: 250%;">ロボットシステム学</h1>
<h2>第4回</h2>
上田 隆一

2016年9月?日\@千葉工業大学

<!--nextpage-->
<h2>今日の内容</h2>
<ul>
 	<li>プロセス等、Linuxの仕組みについて
<ul>
 	<li>OSなしのマイコンとの違いは何か？</li>
</ul>
</li>
</ul>
<!--nextpage-->
<h2>プロセス</h2>
<ul>
 	<li>プログラム実行の一単位
<ul>
 	<li>実行中のプログラム＋OSが準備した付帯情報</li>
</ul>
</li>
 	<li>プロセスID、ユーザ、親プロセス
<ul>
 	<li>普段はps(1)やtop(1)で調査</li>
 	<li>CPUやメモリ使用量、ゴミプロセスがないか調査、等</li>
</ul>
</li>
 	<li>一つのプロセスについて調査したければ/proc/&lt;プロセス番号&gt;を見る
<ul>
 	<li>プロセス情報もファイルで提供される。なんでもファイル</li>
</ul>
</li>
</ul>
<!--nextpage-->
<h2>カーネルから見たプロセス</h2>
<ul>
 	<li>リソースを割り当てる一単位
<ul>
 	<li>メモリの割り当て</li>
 	<li>プログラムが自身のプロセス外のメモリを参照しないよう保護</li>
 	<li>仮想アドレス空間</li>
 	<li>CPU の利用時間（タイムシェアリング）</li>
 	<li>優先度の高低を考慮
<ul>
 	<li>端末とのやり取りが多いものほど高頻度
<span style="color: #ffff00;">↑ロボットを動かす時に問題となる</span></li>
</ul>
</li>
</ul>
</li>
</ul>
<!--nextpage-->
<h2>プロセスツリー</h2>
<ul>
 	<li>プロセスはプロセスから生まれる
<ul>
 	<li>fork-execと呼ばれる仕組み</li>
 	<li>家系図（プロセスツリー）ができる
<ul>
 	<li>pstree(1)で調査を</li>
 	<li>initというプロセスからぶら下がる</li>
</ul>
</li>
</ul>
</li>
 	<li>プロセスツリーの役割
<ul>
 	<li>親子間で環境や開いているファイルを引き継ぐ</li>
</ul>
</li>
</ul>
<h2><!--nextpage--></h2>
<h2>プロセスの一生</h2>
<ol>
 	<li>あるプロセスからforkして生まれる</li>
 	<li>新しいプロセスIDをもらう</li>
 	<li>親の情報をすべて自分のメモリ空間にコピー（コピーしない場合もある）</li>
 	<li>（execされた場合）プログラムの部分が入れ替わる
<ul>
 	<li>例: <a href="https://gist.github.com/ryuichiueda/063765e1e0d8b1e8a501" target="_blank">execを行うシェルスクリプト</a></li>
</ul>
</li>
 	<li>プログラム実行</li>
 	<li>終了。終了ステータスを返す
<ul>
 	<li>0が正常終了、1が何らかの異常</li>
</ul>
</li>
</ol>
